<div class="container-fluid py-4">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2 class="fw-bold">{{ title }}</h2>
    @if (content.length !== 0) {
      <div class="d-flex gap-2">
        <button
          mat-icon-button
          [disabled]="!canGoPrevious() || isLoading"
          (click)="onPreviousPage()"
          class="nav-arrow">
          <mat-icon>chevron_left</mat-icon>
        </button>
        <button
          mat-icon-button
          [disabled]="!canGoNext() || isLoading"
          (click)="onNextPage()"
          class="nav-arrow">
          <mat-icon>chevron_right</mat-icon>
        </button>
      </div>
    }
  </div>

  @if (isLoading) {
    <div class="d-flex justify-content-center p-5">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
    </div>
  } @else {
    @if (content.length === 0) {
      <div class="d-flex flex-column justify-content-center align-items-center p-5 text-center">
        <mat-icon class="text-muted mb-3" style="font-size: 64px; width: 64px; height: 64px;">movie</mat-icon>
        <h4 class="text-muted mb-2">No {{ title }} Found</h4>
        <p class="text-muted">There are currently no {{ title.toLowerCase() }} available. Please check back later or try
          browsing other genres.</p>
      </div>
    } @else {
      <div class="row g-3">
        @for (item of content; track item.id) {
          <div class="col-md-4 col-lg-2">
            <mat-card class="content-card h-100 position-relative">
              <!-- Three dots menu -->
              <button
                mat-icon-button
                [matMenuTriggerFor]="contentMenu"
                class="position-absolute top-0 end-0 m-2 text-white bg-dark bg-opacity-75 rounded-circle"
                style="z-index: 10;">
                <mat-icon>more_vert</mat-icon>
              </button>

              <mat-menu #contentMenu="matMenu">
                <button mat-menu-item (click)="onMoreInfo(item.id)">
                  <mat-icon>info_outline</mat-icon>
                  <span>More info</span>
                </button>
                @if (isWatchlist) {
                  <button mat-menu-item (click)="onAddToList(item.id)">
                    <mat-icon>remove</mat-icon>
                    <span>Remove from My List</span>
                  </button>
                } @else {
                  <button mat-menu-item (click)="onAddToList(item.id)">
                    <mat-icon>playlist_add</mat-icon>
                    <span>Add to My List</span>
                  </button>
                }
              </mat-menu>

              <img
                mat-card-image
                [src]="item.thumbnailUrl"
                [alt]="item.title"
                class="content-thumbnail">
              <mat-card-content class="p-3">
                <h6 class="card-title fw-bold mb-2">{{ item.title }}</h6>
                <p class="text-muted small mb-2">{{ item.contentType.name }} â€¢ {{ item.releaseDate | date:'yyyy' }}</p>
                <div class="d-flex flex-wrap gap-1 mb-2">
                  @for (genre of item.genres; track genre.id) {
                    <span class="badge bg-secondary small">{{ genre.name }}</span>
                  }
                </div>
                <p class="card-text small text-truncate">{{ item.description }}</p>
              </mat-card-content>
              <mat-card-actions class="p-3 pt-0">
                <button mat-raised-button color="primary" class="w-100" (click)="onPlayContent(item.id)">
                  <mat-icon class="me-1">play_arrow</mat-icon>
                  Watch Now
                </button>
              </mat-card-actions>
            </mat-card>
          </div>
        }
      </div>
    }
  }

  <!-- Pagination Info -->
  @if (!isLoading && content.length > 0) {
    <div class="d-flex justify-content-center mt-4">
      <small class="text-muted">
        Page {{ currentPage + 1 }} of {{ totalPages }}
      </small>
    </div>
  }
</div>
