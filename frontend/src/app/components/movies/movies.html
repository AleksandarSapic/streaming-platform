<!-- Navigation Toolbar -->
<mat-toolbar class="d-flex justify-content-between p-5 bg-primary-subtle">
  <span class="navbar-brand" [routerLink]="['/browse']">StreamPlatform</span>

  <div>
    <nav class="navbar navbar-expand-lg navbar-light bg-primary-subtle">
      <ul class="navbar-nav">
        <li class="nav-item">
          <a [routerLink]="['/browse']"
             [routerLinkActive]="['active']"
             class="nav-link">Home</a>
        </li>
        <li class="nav-item">
          <a [routerLink]="['/movies']"
             [routerLinkActive]="['active']"
             class="nav-link">Movies</a>
        </li>
        <li class="nav-item">
          <a [routerLink]="['/series']"
             [routerLinkActive]="['active']"
             class="nav-link">Shows</a>
        </li>
        <li class="nav-item">
          <a [routerLink]="['/my-list']"
             [routerLinkActive]="['active']"
             class="nav-link">My List</a>
        </li>
      </ul>
    </nav>
  </div>

  <div class="d-flex align-items-center gap-2">
    <mat-form-field appearance="outline">
      <mat-icon matPrefix>search</mat-icon>
      <input matInput placeholder="Search...">
    </mat-form-field>

    <button mat-icon-button [matMenuTriggerFor]="profileMenu">
      <mat-icon>account_circle</mat-icon>
    </button>

    <mat-menu #profileMenu="matMenu">
      <div class="px-3 py-2 text-center fw-bold">
        {{ currentUser()?.fullName }}
      </div>
      <mat-divider></mat-divider>
      <a mat-menu-item [routerLink]="['/account']">
        <mat-icon>person</mat-icon>
        <span>Visit Profile</span>
      </a>
      <button mat-menu-item (click)="logout()">
        <mat-icon>logout</mat-icon>
        <span>Log Out</span>
      </button>
    </mat-menu>
  </div>
</mat-toolbar>

<!-- Genre Filter Section -->
<div class="d-flex flex-wrap gap-2 container-fluid py-4">
  <mat-chip-set>
    <mat-chip
      (click)="onGenreSelected(null)"
      [class.selected]="selectedGenre() === null"
      class="genre-chip">
      All Movies
    </mat-chip>
    @for (genre of genres(); track genre.id) {
      <mat-chip
        (click)="onGenreSelected(genre.id)"
        [class.selected]="selectedGenre() === genre.id"
        class="genre-chip">
        {{ genre.name }}
      </mat-chip>
    }
  </mat-chip-set>
</div>

<!-- Conditional Content Display -->
@if (isAllMoviesSelected()) {
  <!-- Show Action and Drama sections when All Movies is selected -->

    <!-- Action Movies Section -->
  <app-content-section
    title="Action Movies"
    [content]="actionMovies()"
    [isLoading]="actionIsLoading()"
    [currentPage]="actionCurrentPage()"
    [totalPages]="actionTotalPages()"
    (previousPage)="previousActionPage()"
    (nextPage)="nextActionPage()"
    (addToList)="addToMyList($event)">
  </app-content-section>

  <!-- Drama Movies Section -->
  <app-content-section
    title="Drama Movies"
    [content]="dramaMovies()"
    [isLoading]="dramaIsLoading()"
    [currentPage]="dramaCurrentPage()"
    [totalPages]="dramaTotalPages()"
    (previousPage)="previousDramaPage()"
    (nextPage)="nextDramaPage()"
    (addToList)="addToMyList($event)">
  </app-content-section>
} @else {
  <!-- Show filtered content section when specific genre is selected -->
  <app-content-section
    [title]="selectedGenreName() + ' Movies'"
    [content]="filteredContent()"
    [isLoading]="filteredIsLoading()"
    [currentPage]="filteredCurrentPage()"
    [totalPages]="filteredTotalPages()"
    (previousPage)="previousFilteredPage()"
    (nextPage)="nextFilteredPage()"
    (addToList)="addToMyList($event)">
  </app-content-section>
}
